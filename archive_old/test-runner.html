<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Sequence Test Runner</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
        .iframe-container {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .console-output {
            background-color: #000;
            color: #00ff00;
            font-family: monospace;
            padding: 10px;
            border-radius: 4px;
            height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Video Sequence Test Runner</h1>
    
    <div class="test-container">
        <h2>Test Controls</h2>
        <p>Use the buttons below to test different aspects of the video sequence implementation.</p>
        
        <button class="test-button" onclick="runVideoTests()">Run Video Tests</button>
        <button class="test-button" onclick="checkTransition()">Check Transition</button>
        <button class="test-button" onclick="checkOverlays()">Check Overlays</button>
        <button class="test-button" onclick="clearConsole()">Clear Console</button>
        
        <div id="status" class="status info">
            Ready to run tests. The video sequence should be visible in the iframe below.
        </div>
    </div>
    
    <div class="test-container">
        <h2>Application Preview</h2>
        <div class="iframe-container">
            <iframe src="http://localhost:3000" id="appFrame"></iframe>
        </div>
    </div>
    
    <div class="test-container">
        <h2>Test Output</h2>
        <div id="console" class="console-output">Console output will appear here...</div>
    </div>

    <script>
        const iframe = document.getElementById('appFrame');
        const consoleDiv = document.getElementById('console');
        const statusDiv = document.getElementById('status');
        
        // Override console in the iframe to capture output
        iframe.addEventListener('load', () => {
            try {
                const iframeWindow = iframe.contentWindow;
                const originalConsole = {
                    log: iframeWindow.console.log,
                    error: iframeWindow.console.error,
                    warn: iframeWindow.console.warn,
                    info: iframeWindow.console.info
                };
                
                // Create a custom console that outputs to our div
                iframeWindow.console = {
                    log: function(...args) {
                        originalConsole.log.apply(iframeWindow.console, args);
                        appendToConsole('LOG', args);
                    },
                    error: function(...args) {
                        originalConsole.error.apply(iframeWindow.console, args);
                        appendToConsole('ERROR', args);
                    },
                    warn: function(...args) {
                        originalConsole.warn.apply(iframeWindow.console, args);
                        appendToConsole('WARN', args);
                    },
                    info: function(...args) {
                        originalConsole.info.apply(iframeWindow.console, args);
                        appendToConsole('INFO', args);
                    }
                };
                
                // Inject our test script into the iframe
                const testScript = document.createElement('script');
                testScript.src = './test-video-sequence.js';
                iframeWindow.document.head.appendChild(testScript);
                
                updateStatus('Test script loaded and ready', 'success');
            } catch (error) {
                updateStatus('Error setting up test environment: ' + error.message, 'error');
                appendToConsole('ERROR', ['Setup Error:', error.message]);
            }
        });
        
        function appendToConsole(type, args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            consoleDiv.textContent += `[${timestamp}] ${type}: ${message}\n`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        function updateStatus(message, type = 'info') {
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }
        
        function runVideoTests() {
            try {
                iframe.contentWindow.testVideoSequence.runAllTests();
                updateStatus('Running video sequence tests...', 'info');
            } catch (error) {
                updateStatus('Error running tests: ' + error.message, 'error');
                appendToConsole('ERROR', ['Test Error:', error.message]);
            }
        }
        
        function checkTransition() {
            try {
                iframe.contentWindow.testVideoSequence.checkTransitionBackgrounds();
                updateStatus('Checking transition backgrounds...', 'info');
            } catch (error) {
                updateStatus('Error checking transition: ' + error.message, 'error');
                appendToConsole('ERROR', ['Transition Error:', error.message]);
            }
        }
        
        function checkOverlays() {
            try {
                iframe.contentWindow.testVideoSequence.checkTextOverlays();
                updateStatus('Checking text overlays...', 'info');
            } catch (error) {
                updateStatus('Error checking overlays: ' + error.message, 'error');
                appendToConsole('ERROR', ['Overlay Error:', error.message]);
            }
        }
        
        function clearConsole() {
            consoleDiv.textContent = 'Console output will appear here...\n';
            updateStatus('Console cleared', 'info');
        }
        
        // Initial status
        updateStatus('Loading application...', 'info');
    </script>
</body>
</html>