<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Responsiveness Test Helper</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .pass {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .fail {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .device-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Mobile Responsiveness Test Helper</h1>
    
    <div class="test-section">
        <h2>Device Simulation</h2>
        <div class="device-buttons">
            <button class="test-button" onclick="resizeTo(375, 667)">iPhone SE (375x667)</button>
            <button class="test-button" onclick="resizeTo(414, 896)">iPhone Pro (414x896)</button>
            <button class="test-button" onclick="resizeTo(768, 1024)">iPad (768x1024)</button>
            <button class="test-button" onclick="resizeTo(1024, 1366)">iPad Pro (1024x1366)</button>
            <button class="test-button" onclick="resizeTo(896, 414)">iPhone Landscape (896x414)</button>
            <button class="test-button" onclick="resizeTo(window.screen.width, window.screen.height)">Full Screen</button>
        </div>
        <div id="viewport-info" class="result info">
            Current viewport: <span id="viewport-size"></span>
        </div>
    </div>

    <div class="test-section">
        <h2>Test Frame</h2>
        <iframe src="http://localhost:3001" id="test-frame"></iframe>
    </div>

    <div class="test-section">
        <h2>Automated Tests</h2>
        <button class="test-button" onclick="runTests()">Run All Tests</button>
        <button class="test-button" onclick="testTextWrapping()">Test Text Wrapping</button>
        <button class="test-button" onclick="testTouchTargets()">Test Touch Targets</button>
        <button class="test-button" onclick="testViewportSettings()">Test Viewport Settings</button>
        <button class="test-button" onclick="testReducedMotion()">Test Reduced Motion</button>
        <button class="test-button" onclick="checkConsoleErrors()">Check Console Errors</button>
        <div id="test-results"></div>
    </div>

    <script>
        function updateViewportInfo() {
            document.getElementById('viewport-size').textContent = 
                `${window.innerWidth}x${window.innerHeight}`;
        }

        function resizeTo(width, height) {
            window.resizeTo(width, height);
            setTimeout(updateViewportInfo, 100);
        }

        function addResult(testName, passed, details) {
            const resultsDiv = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${passed ? 'pass' : 'fail'}`;
            resultDiv.innerHTML = `
                <strong>${testName}:</strong> ${passed ? 'PASS' : 'FAIL'}
                ${details ? `<br><small>${details}</small>` : ''}
            `;
            resultsDiv.appendChild(resultDiv);
        }

        function testTextWrapping() {
            const iframe = document.getElementById('test-frame');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const headings = iframeDoc.querySelectorAll('h1');
            let allPass = true;
            let details = [];

            headings.forEach((heading, index) => {
                const styles = window.getComputedStyle(heading);
                const overflow = styles.overflow;
                const textOverflow = styles.textOverflow;
                const whiteSpace = styles.whiteSpace;
                const scrollWidth = heading.scrollWidth;
                const clientWidth = heading.clientWidth;
                
                const passes = scrollWidth <= clientWidth;
                allPass = allPass && passes;
                
                details.push(`H1 ${index + 1}: ${passes ? 'OK' : 'Overflow'} (${scrollWidth}px vs ${clientWidth}px)`);
            });

            addResult('Text Wrapping', allPass, details.join('<br>'));
        }

        function testTouchTargets() {
            const iframe = document.getElementById('test-frame');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const buttons = iframeDoc.querySelectorAll('button, a, input');
            let allPass = true;
            let details = [];

            buttons.forEach((button, index) => {
                const rect = button.getBoundingClientRect();
                const width = rect.width;
                const height = rect.height;
                const passes = width >= 44 && height >= 44;
                allPass = allPass && passes;
                
                details.push(`${button.tagName} ${index + 1}: ${passes ? 'OK' : 'Too small'} (${width}x${height}px)`);
            });

            addResult('Touch Targets (44x44px min)', allPass, details.join('<br>'));
        }

        function testViewportSettings() {
            const iframe = document.getElementById('test-frame');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const viewportMeta = iframeDoc.querySelector('meta[name="viewport"]');
            const themeColorMeta = iframeDoc.querySelector('meta[name="theme-color"]');
            
            const viewportContent = viewportMeta ? viewportMeta.getAttribute('content') : '';
            const themeColor = themeColorMeta ? themeColorMeta.getAttribute('content') : '';
            
            const hasDeviceWidth = viewportContent.includes('width=device-width');
            const hasInitialScale = viewportContent.includes('initial-scale=1.0');
            const hasMaxScale = viewportContent.includes('maximum-scale=1.0');
            const hasThemeColor = themeColor && themeColor === '#000000';
            
            const allPass = hasDeviceWidth && hasInitialScale && hasMaxScale && hasThemeColor;
            
            const details = `
                Viewport: ${viewportContent}<br>
                Theme Color: ${themeColor}<br>
                Device Width: ${hasDeviceWidth ? '✅' : '❌'}<br>
                Initial Scale: ${hasInitialScale ? '✅' : '❌'}<br>
                Max Scale: ${hasMaxScale ? '✅' : '❌'}<br>
                Theme Color: ${hasThemeColor ? '✅' : '❌'}
            `;
            
            addResult('Viewport Settings', allPass, details);
        }

        function testReducedMotion() {
            const iframe = document.getElementById('test-frame');
            const iframeWindow = iframe.contentWindow;
            
            // Test reduced motion detection
            const hasReducedMotion = iframeWindow.matchMedia && 
                iframeWindow.matchMedia('(prefers-reduced-motion: reduce)').matches;
            
            // Check for motion-related CSS
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            const animatedElements = iframeDoc.querySelectorAll('[class*="animate-"], [class*="motion-"]');
            
            const details = `
                Reduced Motion Detected: ${hasReducedMotion ? 'Yes' : 'No'}<br>
                Animated Elements Found: ${animatedElements.length}<br>
                Note: Test with browser's reduced motion preference enabled for full verification
            `;
            
            addResult('Reduced Motion Support', true, details);
        }

        function checkConsoleErrors() {
            const iframe = document.getElementById('test-frame');
            const iframeWindow = iframe.contentWindow;
            
            // Create a simple error checker
            let errors = [];
            const originalError = iframeWindow.console.error;
            const originalLog = iframeWindow.console.log;
            
            iframeWindow.console.error = function(...args) {
                errors.push(args.join(' '));
                originalError.apply(this, args);
            };
            
            // Wait a moment then check
            setTimeout(() => {
                iframeWindow.console.error = originalError;
                
                const hasErrors = errors.length > 0;
                const details = hasErrors ? 
                    `Found ${errors.length} error(s):<br>${errors.join('<br>')}` : 
                    'No console errors detected';
                
                addResult('Console Errors', !hasErrors, details);
            }, 2000);
        }

        function runTests() {
            document.getElementById('test-results').innerHTML = '';
            
            setTimeout(testTextWrapping, 500);
            setTimeout(testTouchTargets, 1000);
            setTimeout(testViewportSettings, 1500);
            setTimeout(testReducedMotion, 2000);
            setTimeout(checkConsoleErrors, 2500);
        }

        // Initialize
        window.addEventListener('load', () => {
            updateViewportInfo();
            window.addEventListener('resize', updateViewportInfo);
        });
    </script>
</body>
</html>